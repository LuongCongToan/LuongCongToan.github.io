System.register("chunks:///core/event-manager.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,n){var t,s,i,r;return{setters:[function(e){t=e.createClass,s=e.classCallCheck},function(e){i=e.cclegacy}],execute:function(){i._RF.push({},"36cab9v06JFnLtfyFLUdxyy","event-manager",void 0),(r=function(){function e(){s(this,e),this.eventListenners={}}return t(e,[{key:"register",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r={target:t,callback:n,priority:s,excuteOnce:i};return this.eventListenners[e]?this.eventListenners[e].push(r):(this.eventListenners[e]=[],this.eventListenners[e].push(r)),this.eventListenners[e].sort((function(e,n){return n.priority-e.priority})),n}},{key:"registerOnce",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.register(e,n,t,s,!0)}},{key:"unregister",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.eventListenners[e]){for(var s=[],i=0;i<this.eventListenners[e].length;i++){var r=this.eventListenners[e][i];null==n?r.target==t&&s.push(i):r.target==t&&r.callback==n&&s.push(i)}this.eventListenners[e]=this.eventListenners[e].filter((function(e,n){return-1===s.indexOf(n)})),0==this.eventListenners[e].length&&delete this.eventListenners[e]}}},{key:"unregisterTarget",value:function(e){var n=this,t=function(t){for(var s=[],i=0;i<n.eventListenners[t].length;i++){n.eventListenners[t][i].target==e&&s.push(i)}n.eventListenners[t]=n.eventListenners[t].filter((function(e,n){return-1===s.indexOf(n)})),0==n.eventListenners[t].length&&delete n.eventListenners[t]};for(var s in this.eventListenners)t(s)}},{key:"remove",value:function(e){this.eventListenners[e]&&delete this.eventListenners[e]}},{key:"dispatch",value:function(e){for(var n=this,t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];if(this.eventListenners[e]){var r=[];this.eventListenners[e].forEach((function(e){e.target?e.callback.call(e.target,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9]):e.callback(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9]),1==e.excuteOnce&&r.push(e)})),r.forEach((function(t){n.unregister(e,t.callback,t.target)}))}}}],[{key:"instance",get:function(){return null==e._instance&&(e._instance=new e),e._instance}}]),e}())._instance=null,i._RF.pop(),e("default",r)}}}));

System.register("chunks:///core/AmaWrapper.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./event-manager.js"],(function(e,t){var n,c,a,i,o,s,r,l,u,d;return e({_class:void 0,_class2:void 0,_temp:void 0}),{setters:[function(e){n=e.createClass,c=e.classCallCheck},function(e){a=e.cclegacy},function(e){i=e.default}],execute:function(){a._RF.push({},"c2dd9GOJSZEgpVo2aeNsj4s","AmaWrapper",void 0),l=cc._decorator,u=l.ccclass,l.property,d=u((r=s=function(){function e(){c(this,e)}return n(e,[{key:"init",value:function(e){window.song=e,AmaSdk.MepEventEmitter.emit("create")}},{key:"start",value:function(){AmaSdk.MepEventEmitter.on("start",(function(e){i.instance.dispatch("loadmp3",e.mp3Url),AmaSdk.ContentReader.getNotes(e.levelUrl).then((function(e){i.instance.dispatch("midi_load_completed",e)})).catch((function(e){console.log({error:e})}))}))}},{key:"emitLoadCompleted",value:function(){AmaSdk.MepEventEmitter.emit("load-completed")}}],[{key:"instance",get:function(){return null==e._instance&&(e._instance=new e),e._instance}}]),e}(),s._instance=null,o=r))||o,a._RF.pop(),e("default",d)}}}));

System.register("chunks:///core/DownloadFileUtil.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var c,l,n,o,s,u,a;return e("_class",void 0),{setters:[function(e){c=e.createClass,l=e.classCallCheck},function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"7201ePfkipN5KaHHbGzw05v","DownloadFileUtil",void 0),s=cc._decorator,u=s.ccclass,s.property,a=u(o=function(){function e(){l(this,e)}return c(e,null,[{key:"get",value:function(e,t){var c=new XMLHttpRequest;c.open("GET",e,!0);try{c.send(),c.status}catch(e){cc.log(""+e)}}},{key:"downloadTextFile",value:function(e,t){}}]),e}())||o,n._RF.pop(),e("default",a)}}}));

System.register("chunks:///core/InputManager.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./event-manager.js"],(function(n,t){var e,o,c,u,s,a,i,h,r,T,p,v;return n({_dec:void 0,_class:void 0}),{setters:[function(n){e=n.inherits,o=n.createClass,c=n.classCallCheck,u=n.possibleConstructorReturn,s=n.getPrototypeOf},function(n){a=n.cclegacy,i=n._decorator,h=n.Component},function(n){r=n.default}],execute:function(){a._RF.push({},"95219+M4RFCRKhETQ8Ig9gH","InputManager",void 0),v=i.ccclass,i.property,n("InputManager",(T=v("InputManager"),T(p=function(n){function t(){return c(this,t),u(this,s(t).apply(this,arguments))}return e(t,n),o(t,[{key:"onLoad",value:function(){var n=cc.find("Canvas");n.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),n.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),n.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),n.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)}},{key:"onTouchStart",value:function(n){r.instance.dispatch("touch-start",n.touch)}},{key:"onTouchMove",value:function(n){r.instance.dispatch("touch-move",n.touch)}},{key:"onTouchEnd",value:function(n){r.instance.dispatch("touch-end",n.touch)}},{key:"onTouchCancel",value:function(n){r.instance.dispatch("touch-cancel",n.touch)}},{key:"onDestroy",value:function(){var n=cc.find("Canvas");n.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),n.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),n.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),n.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)}}]),t}(h))||p)),a._RF.pop()}}}));

System.register("chunks:///core/MidiNoteGenerator.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,c){var t,r,o,s,i,n;return e("_class",void 0),{setters:[function(e){t=e.classCallCheck},function(e){r=e.cclegacy}],execute:function(){r._RF.push({},"04a62ezrR5GapotwuzzpQuc","MidiNoteGenerator",void 0),s=cc._decorator,i=s.ccclass,s.property,n=i(o=function e(){t(this,e)})||o,r._RF.pop(),e("default",n)}}}));

System.register("chunks:///core/NoteData.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var c,a,o,s,r,n;return e({_dec:void 0,_class:void 0}),{setters:[function(e){c=e.classCallCheck},function(e){a=e.cclegacy,o=e._decorator}],execute:function(){a._RF.push({},"2e38aSVwmdPQqep8SzPFQbU","NoteData",void 0),n=o.ccclass,o.property,e("NoteData",(s=n("NoteData"),s(r=function e(){c(this,e)})||r)),a._RF.pop()}}}));

System.register("chunks:///core/SoundManager.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(n,i){var e,s,t,u,o,a,c,l,d;return n({_class:void 0,_class2:void 0,_temp:void 0}),{setters:[function(n){e=n.createClass,s=n.classCallCheck},function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"f37c1KHiRxOOJvZJAt/KgNw","SoundManager",void 0),c=cc._decorator,l=c.ccclass,c.property,d=l((a=o=function(){function n(){s(this,n),this.playingSounds={},this.sounds={}}return e(n,[{key:"load",value:function(n,i){var e=this;this.sounds[n]||cc.loader.loadRes(n,cc.AudioClip,(function(i,s){e.sounds[n]=s,cc.audioEngine.play(s,!0,1)}))}},{key:"playMusic",value:function(n){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(n=n.toLowerCase(),!this.isPlaying(n)&&this.sounds[n]){var s=cc.audioEngine.play(this.sounds[n],i,e);this.playingSounds[n]=s}}},{key:"pause",value:function(n){n=n.toLowerCase(),null!=this.playingSounds[n]&&cc.audioEngine.pause(this.playingSounds[n])}},{key:"resume",value:function(n){n=n.toLowerCase(),null!=this.playingSounds[n]&&cc.audioEngine.resume(this.playingSounds[n])}},{key:"stop",value:function(n){n=n.toLowerCase(),null!=this.playingSounds[n]&&(cc.audioEngine.stop(this.playingSounds[n]),delete this.playingSounds[n])}},{key:"isPlaying",value:function(n){return n=n.toLowerCase(),null!=this.playingSounds[n]&&cc.audioEngine.getState(this.playingSounds[n])==cc.audioEngine.AudioState.PLAYING}}],[{key:"instance",get:function(){return null==n._instance&&(n._instance=new n),n._instance}}]),n}(),o._instance=null,u=a))||u,t._RF.pop(),n("default",d)}}}));

System.register("chunks:///game/CamFollow.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,o){var i,e,n,r,s,a,l,c,p,u,h,d,f,v,y,m,g,_,C,w;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inherits,n=t.classCallCheck,r=t.possibleConstructorReturn,s=t.getPrototypeOf,a=t.initializerDefineProperty,l=t.assertThisInitialized,c=t.createClass},function(t){p=t.cclegacy,u=t._decorator,h=t.Node,d=t.Component}],execute:function(){p._RF.push({},"5ae09jZSLJNa7vdXqCx1SlF","CamFollow",void 0),C=u.ccclass,w=u.property,t("CamFollow",(f=C("CamFollow"),v=w(h),f((g=i((m=function(t){function o(){var t,i;n(this,o);for(var e=arguments.length,c=new Array(e),p=0;p<e;p++)c[p]=arguments[p];return i=r(this,(t=s(o)).call.apply(t,[this].concat(c))),a(i,"target",g,l(i)),a(i,"smoothTime",_,l(i)),i}return e(o,t),c(o,[{key:"start",value:function(){this._offset=cc.v3(this.node.position.x-this.target.position.x,this.node.position.y-this.target.position.y,this.node.position.z-this.target.position.z)}},{key:"update",value:function(t){this.SmoothFollow()}},{key:"SmoothFollow",value:function(){var t=this._offset.y+this.target.position.y;this.node.position=cc.v3(this.node.position.x,t,this.node.position.z)}}]),o}(d)).prototype,"target",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=i(m.prototype,"smoothTime",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y=m))||y)),p._RF.pop()}}}));

System.register("chunks:///game/ComponentInstance.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(n,e){var t,c,s;return{setters:[function(n){t=n.createClass,c=n.classCallCheck},function(n){s=n.cclegacy}],execute:function(){s._RF.push({},"01918s/mLlL0aBuX63ifUrr","ComponentInstance",void 0),n("ComponentInstance",function(){function n(){c(this,n)}return t(n,null,[{key:"registerInstance",value:function(e,t){null!=n[e]?console.error(e,"is duplicate"):n[e]=t}},{key:"reset",value:function(){n.MainUI&&(n.MainUI=null)}}]),n}()),s._RF.pop()}}}));

System.register("chunks:///game/LinePoint.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,i,o,c,r,s,u,l,a,p;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.inherits,i=t.classCallCheck,o=t.possibleConstructorReturn,c=t.getPrototypeOf},function(t){r=t.cclegacy,s=t._decorator,u=t.Component}],execute:function(){r._RF.push({},"b361d/gkvBO4b3Fl4qaRC42","LinePoint",void 0),p=s.ccclass,s.property,t("LinePoint",(l=p("LinePoint"),l(a=function(t){function e(){return i(this,e),o(this,c(e).apply(this,arguments))}return n(e,t),e}(u))||a)),r._RF.pop()}}}));

System.register("chunks:///game/CurveLine.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./LinePoint.js"],(function(e,i){var n,t,o,s,r,l,a,c,h,p,u,d,g,f,m,v,P,y,_,C;return e({_dec:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inherits,o=e.classCallCheck,s=e.possibleConstructorReturn,r=e.getPrototypeOf,l=e.initializerDefineProperty,a=e.assertThisInitialized,c=e.createClass},function(e){h=e.cclegacy,p=e._decorator,u=e.LineComponent,d=e.Vec3,g=e.Component},function(e){f=e.LinePoint}],execute:function(){h._RF.push({},"ca50fNT2fJC5KaJzRP2fESY","CurveLine",void 0),_=p.ccclass,C=p.property,e("CurveLine",(m=_("CurveLine"),m((y=n((P=function(e){function i(){var e,n;o(this,i);for(var t=arguments.length,c=new Array(t),h=0;h<t;h++)c[h]=arguments[h];return n=s(this,(e=r(i)).call.apply(e,[this].concat(c))),l(n,"segmentSize",y,a(n)),n.linePoints=null,n.lineSegments=[],n}return t(i,e),c(i,[{key:"start",value:function(){this.lineRenderer=this.getComponent(u),this.linePoints=this.getComponentsInChildren(f),this.linePoints.sort((function(e,i){return e.node.position.y-i.node.position.y})),this.computeSegments(),this.lineRenderer._positions=this.lineSegments,this.lineRenderer._model.addLineVertexData(this.lineRenderer._positions,this.lineRenderer._width,this.lineRenderer._color),console.log("aaa "+this.lineRenderer.positions)}},{key:"computeSegments",value:function(){for(var e=0;e<this.linePoints.length;e++)if(this.lineSegments.push(this.linePoints[e].node.position),e+1<this.linePoints.length)for(var i=d.distance(this.linePoints[e].node.position,this.linePoints[e+1].node.position),n=Math.round(i/this.segmentSize),t=1;t<n;t++){var o=new d(this.linePoints[e].node.position.x,this.linePoints[e].node.position.y+t*this.segmentSize,this.linePoints[e].node.position.y);this.lineSegments.push(o)}}}]),i}(g)).prototype,"segmentSize",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),v=P))||v)),h._RF.pop()}}}));

System.register("chunks:///game/GameConstant.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var s,c,n,a,o,i,l,r;return t({_dec:void 0,_class:void 0,_class2:void 0,_temp:void 0}),{setters:[function(t){s=t.classCallCheck},function(t){c=t.cclegacy,n=t._decorator}],execute:function(){c._RF.push({},"0ff040/pQpGFJwETQROj9jW","GameConstant",void 0),r=n.ccclass,n.property,t("GameConstant",(a=r("GameConstant"),a((l=i=function t(){s(this,t)},i.PLAYER_MOVE_SPEED=4,i.BIASED_OFFSET=.5,o=l))||o)),c._RF.pop()}}}));

System.register("chunks:///game/LevelData.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,i){var e,l,a,s,n,r,o,h,c,u,L,d,B;return t({_dec:void 0,_class:void 0,_dec2:void 0,_class2:void 0,_temp:void 0,MIDINote:void 0,BallDirection:void 0}),{setters:[function(t){e=t.createClass,l=t.classCallCheck},function(t){a=t.cclegacy,s=t._decorator,n=t.math}],execute:function(){a._RF.push({},"1e5cb2kF8REQYkdTTyUHWHk","LevelData",void 0),u=s.ccclass,s.property,function(t){t[t.C5=72]="C5",t[t.C5_SHARP=73]="C5_SHARP",t[t.D5=74]="D5",t[t.D5_SHARP=75]="D5_SHARP",t[t.E5=76]="E5",t[t.F5=77]="F5",t[t.F5_SHARP=78]="F5_SHARP",t[t.G5=79]="G5",t[t.G5_SHARP=80]="G5_SHARP",t[t.A5=81]="A5",t[t.A5_SHARP=82]="A5_SHARP",t[t.B5=83]="B5",t[t.C6=84]="C6"}(L||t("MIDINote",L={})),function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"}(d||t("BallDirection",d={})),t("BallData",(r=u("BallData"),B=r(o=function(){function t(i,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d.Left;l(this,t),this.timeAppear=i,this.stringIndex=e,this.duration=a,this.ballDir=s}return e(t,[{key:"SetShortNoteBool",value:function(t){return this.isShort=t}}]),t}())||o)),t("LevelData",(h=u("LevelData"),h(c=function(){function t(i){l(this,t),this.BallList=null,this.createLevelData(i)}return e(t,[{key:"createLevelData",value:function(t){var i=this;this.BallList=[],(t=t.filter((function(t){return t.midi<90}))).forEach((function(t){var e=t.midi%12;switch(e){case 0:i.BallList.push(new B(t.time,e,t.duration,d.Left));break;case 1:i.BallList.push(new B(t.time,e,t.duration,d.Middle));break;case 2:i.BallList.push(new B(t.time,e,t.duration,d.Right));break;case 3:i.BallList.push(new B(t.time,e))}}));for(var e=0;e<this.BallList.length;e++)3==this.BallList[e].stringIndex&&(e>0&&n.approx(this.BallList[e].timeAppear,this.BallList[e-1].timeAppear,n.EPSILON)?this.BallList[e-1].SetShortNoteBool(!0):e!=this.BallList.length-1&&n.approx(this.BallList[e+1].timeAppear,this.BallList[e].timeAppear,n.EPSILON)&&this.BallList[e+1].SetShortNoteBool(!0));this.BallList=this.BallList.filter((function(t){return 3!=t.stringIndex})),this.EndOfSongTime=this.BallList[this.BallList.length-1].timeAppear,this.FinalNote=this.BallList.length-1}}]),t}())||c)),a._RF.pop()}}}));

System.register("chunks:///game/MainUI.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./ComponentInstance.js"],(function(e,n){var t,i,o,r,a,s,c,l,u,p,v,d,f,_,y,g,h,b,I,m,C,k;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_class3:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inherits,o=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,c=e.assertThisInitialized,l=e.createClass},function(e){u=e.cclegacy,p=e._decorator,v=e.LabelComponent,d=e.Component},function(e){f=e.ComponentInstance}],execute:function(){u._RF.push({},"14164QjOa5FgYcqAFAvwVVs","MainUI",void 0),C=p.ccclass,k=p.property,e("MainUI",(_=C("MainUI"),y=k(v),_((m=I=function(e){function n(){var e,t;o(this,n);for(var i=arguments.length,l=new Array(i),u=0;u<i;u++)l[u]=arguments[u];return t=r(this,(e=a(n)).call.apply(e,[this].concat(l))),s(t,"scoreLabel",b,c(t)),t}return i(n,e),l(n,[{key:"onLoad",value:function(){f.registerInstance("MainUI",this)}},{key:"start",value:function(){}},{key:"setScore",value:function(e){this.scoreLabel.string=e.toString()}}]),n}(d),I._instance=null,b=t((h=m).prototype,"scoreLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=h))||g)),u._RF.pop()}}}));

System.register("chunks:///game/MusicDataNote.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,s){var e,i,o,c,a,l;return t({_dec:void 0,_class:void 0}),{setters:[function(t){e=t.classCallCheck},function(t){i=t.cclegacy,o=t._decorator}],execute:function(){i._RF.push({},"6a070d7vlpHfoNNxlloDQLo","MusicDataNote",void 0),l=o.ccclass,o.property,t("MusicDataNote",(c=l("MusicDataNote"),c(a=function t(s,i,o,c,a,l,r,u){e(this,t),this.timeAppear=s,this.noteDuration=i,this.noteDir=o,this.isNoteShort=c,this.nextNoteTime=a,this.worldPos=l,this.isLeft=r,this.shouldFlip=u})||a)),i._RF.pop()}}}));

System.register("chunks:///game/NoteController.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var o,r,n,c,s,l,u,i,a,p,C;return t({_dec:void 0,_class:void 0}),{setters:[function(t){o=t.inherits,r=t.createClass,n=t.classCallCheck,c=t.possibleConstructorReturn,s=t.getPrototypeOf},function(t){l=t.cclegacy,u=t._decorator,i=t.Component}],execute:function(){l._RF.push({},"79b7cuS8/ZKd7LC22egO8k7","NoteController",void 0),C=u.ccclass,u.property,t("NoteController",(a=C("NoteController"),a(p=function(t){function e(){return n(this,e),c(this,s(e).apply(this,arguments))}return o(e,t),r(e,[{key:"start",value:function(){}}]),e}(i))||p)),l._RF.pop()}}}));

System.register("chunks:///game/TileNode.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var i,o,n,r,l,c,s,a,u,p,d,f,_,h,v,b,g,y,C,m,x,N,z,S;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,o=e.inherits,n=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,c=e.initializerDefineProperty,s=e.assertThisInitialized,a=e.createClass},function(e){u=e.cclegacy,p=e._decorator,d=e.ModelComponent,f=e.BoxColliderComponent,_=e.Component}],execute:function(){u._RF.push({},"4cc19GDN/dLGoOq2rscCqiH","TileNode",void 0),z=p.ccclass,S=p.property,e("TileNode",(h=z("TileNode"),v=S(cc.Node),b=S(cc.Node),g=S(cc.Node),h((m=i((C=function(e){function t(){var e,i;n(this,t);for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return i=r(this,(e=l(t)).call.apply(e,[this].concat(a))),c(i,"left_explosion_effect",m,s(i)),c(i,"right_explosion_effect",x,s(i)),c(i,"bounceSprite",N,s(i)),i.noteInfo=null,i.collided=!1,i}return o(t,e),a(t,[{key:"start",value:function(){}},{key:"onCollidedWithPlayer",value:function(e){this.collided=!0,this.getComponent(d).enabled=!1,this.getComponent(f).enabled=!1,this.bounceSprite&&(this.bounceSprite.active=!1),e?this.left_explosion_effect.active=!0:this.right_explosion_effect.active=!0}}]),t}(_)).prototype,"left_explosion_effect",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=i(C.prototype,"right_explosion_effect",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=i(C.prototype,"bounceSprite",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=C))||y)),u._RF.pop()}}}));

System.register("chunks:///game/Player.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../core/event-manager.js","./GameConstant.js","./LevelData.js","./TileNode.js"],(function(e,t){var i,o,n,s,r,a,d,h,l,c,u,f,p,v,g,y,m,C,P,S,D,L,_,z,k,W,b,M,R,T,w;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0,PlayerState:void 0,Side:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,o=e.inherits,n=e.classCallCheck,s=e.possibleConstructorReturn,r=e.getPrototypeOf,a=e.initializerDefineProperty,d=e.assertThisInitialized,h=e.createClass},function(e){l=e.cclegacy,c=e._decorator,u=e.Vec3,f=e.ColliderComponent,p=e.v3,v=e.math,g=e.BoxColliderComponent,y=e.Component},function(e){m=e.default},function(e){C=e.GameConstant},function(e){P=e.BallDirection},function(e){S=e.TileNode}],execute:function(){l._RF.push({},"89dcchkp1JLQLpaAr6xBCn9","Player",void 0),M=c.ccclass,R=c.property,function(e){e[e.None=0]="None",e[e.Prepare=1]="Prepare",e[e.Started=2]="Started",e[e.Died=3]="Died",e[e.Paused=4]="Paused",e[e.Finished=5]="Finished"}(T||e("PlayerState",T={})),function(e){e[e.Left=0]="Left",e[e.Mid=1]="Mid",e[e.Right=2]="Right"}(w||e("Side",w={})),e("Player",(D=M("Player"),L=R({type:cc.Float}),_=R({type:cc.Float}),D((W=i((k=function(e){function t(){var e;return n(this,t),(e=s(this,r(t).call(this))).playedTime=0,a(e,"sideWidth",W,d(e)),a(e,"horizonSpeed",b,d(e)),e.side=w.Left,e.isHorizonMove=!1,e.state=T.None,e}return o(t,e),h(t,[{key:"setState",value:function(e){this.state!=e&&(this.state=e)}},{key:"start",value:function(){m.instance.register("touch-start",this.onFingerDown,this),this.node.setPosition(new u(this.getSideX(),0,0)),this.getComponent(f).on("onTriggerEnter",this.onTriggerEnter,this)}},{key:"update",value:function(e){if(this.state==T.Started){this.playedTime+=e;var t=0;if(this.isHorizonMove){t+=e*this.horizonSpeed*(this.side==w.Left?-1:1);var i=this.node.position.x+t;(i>=this.sideWidth||i<=-this.sideWidth)&&(this.isHorizonMove=!1)}var o=this.node.position.add(p(t,e*C.PLAYER_MOVE_SPEED,0));o.x=v.clamp(o.x,-this.sideWidth,this.sideWidth),this.node.position=o}}},{key:"onFingerDown",value:function(e){this.switchDirection()}},{key:"onDestroy",value:function(){m.instance.unregisterTarget(this)}},{key:"getSideX",value:function(){return this.side==w.Left?-this.sideWidth:this.sideWidth}},{key:"onTriggerEnter",value:function(e){var t=e.otherCollider.getComponent(S);null!=t&&(t.collided=!0,m.instance.dispatch("on-collide-tile"),t.noteInfo.isNoteShort?(t.noteInfo.noteDir==P.Left&&this.side==w.Right||t.noteInfo.noteDir==P.Right&&this.side==w.Left)&&(this.isHorizonMove=!1,t.getComponent(g).enabled=!1,t.onCollidedWithPlayer(this.side==w.Left),this.switchDirection()):t.onCollidedWithPlayer(this.side==w.Left))}},{key:"switchDirection",value:function(){this.state==T.Started&&(this.isHorizonMove||(this.side=this.side==w.Left?w.Right:w.Left,this.isHorizonMove=!0))}}]),t}(y)).prototype,"sideWidth",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),b=i(k.prototype,"horizonSpeed",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),z=k))||z)),l._RF.pop()}}}));

System.register("chunks:///game/GamePlay.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../core/event-manager.js","../core/AmaWrapper.js","./ComponentInstance.js","./GameConstant.js","./LevelData.js","./MusicDataNote.js","./TileNode.js","./Player.js"],(function(t,e){var i,a,s,n,l,o,r,u,c,d,h,p,m,b,f,L,_,v,y,g,N,S,D,P,k,I,M,A,C,F,R,G,E,T,w,j,x,U,z,O,B,W,H,K,V;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_temp:void 0,GameState:void 0,GameResult:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,a=t.inherits,s=t.classCallCheck,n=t.possibleConstructorReturn,l=t.getPrototypeOf,o=t.initializerDefineProperty,r=t.assertThisInitialized,u=t.createClass},function(t){c=t.cclegacy,d=t._decorator,h=t.Node,p=t.Prefab,m=t.loader,b=t.instantiate,f=t.math,L=t.PhysicsSystem,_=t.Component},function(t){v=t.default},function(t){y=t.default},function(t){g=t.ComponentInstance},function(t){N=t.GameConstant},function(t){S=t.LevelData},function(t){D=t.MusicDataNote},function(t){P=t.TileNode},function(t){k=t.Player,I=t.PlayerState}],execute:function(){c._RF.push({},"4b7e6kVmKdO67FBhn0QocH7","GamePlay",void 0),W=d.ccclass,H=d.property,function(t){t[t.Init=0]="Init",t[t.Idle=1]="Idle",t[t.Run=2]="Run",t[t.Paused=3]="Paused",t[t.End=4]="End"}(K||t("GameState",K={})),function(t){t[t.Win=0]="Win",t[t.Lose=1]="Lose"}(V||t("GameResult",V={})),t("GamePlay",(M=W("GamePlay"),A=H({type:cc.Float}),C=H([h]),F=H(p),R=H(p),G=H(k),E=H(h),M((j=i((w=function(t){function e(){var t,i;s(this,e);for(var a=arguments.length,u=new Array(a),c=0;c<a;c++)u[c]=arguments[c];return i=n(this,(t=l(e)).call.apply(t,[this].concat(u))),o(i,"laneWidth",j,r(i)),o(i,"lines",x,r(i)),o(i,"blueNode",U,r(i)),o(i,"pinkNode",z,r(i)),o(i,"player",O,r(i)),o(i,"mainCamera",B,r(i)),i.gameState=K.Init,i.gameResult=V.Lose,i.gameScore=0,i.levelData=null,i._ballList=null,i.tileNodes=[],i.musicNoteDatas=[],i.midiUrl="https://luongcongtoan.github.io/cloud/Unity_TheFatRat.bin",i.mp3Url="https://luongcongtoan.github.io/cloud/Unity_TheFatRat.mp3",i.backgroundMusic=null,i.isMidiLoaded=!1,i.isMusicLoaded=!1,i}return a(e,t),u(e,[{key:"onLoad",value:function(){y.instance,y.instance.init({songId:"yeu-nhu-ngay-hom-qua",mp3Url:this.mp3Url,levelUrl:this.midiUrl,duration:287,title:"Miền Cát Trắng",artist:"Lâm Chí Khanh"}),y.instance.start(),v.instance.register("loadmp3",this.loadBGMusic,this),v.instance.register("midi_load_completed",this.onMidiLoaded.bind(this),this),v.instance.register("on-collide-tile",this.onCollideTileNode,this),this.setState(K.Init),this.player.setState(I.Prepare)}},{key:"setState",value:function(t){this.gameState!=t&&(this.gameState=t,t==K.Run&&this.backgroundMusic.play())}},{key:"loadBGMusic",value:function(t){var e=this;m.load(t,(function(t,e,i){cc.log("aaa "+t+" bbb "+e)}),(function(t,i){e.backgroundMusic=i,e.isMusicLoaded=!0}))}},{key:"onMidiLoaded",value:function(t){var e=this;this.levelData=new S(t),this._ballList=this.levelData.BallList,this.preGenerateNoteData((function(t){for(var i=0;i<e.musicNoteDatas.length;i++)e.musicNoteDatas[i].isNoteShort?e.createNote(e.pinkNode,e.musicNoteDatas[i]):e.createNote(e.blueNode,e.musicNoteDatas[i]);e.isMidiLoaded=!0}))}},{key:"createNote",value:function(t,e){var i=b(t);this.node.addChild(i),i.setPosition(e.worldPos);var a=i.getComponent(P);a.noteInfo=e,this.tileNodes.push(a)}},{key:"start",value:function(){y.instance.emitLoadCompleted()}},{key:"preGenerateNoteData",value:function(t){this.musicNoteDatas=[];for(var e=0,i=0;i<this._ballList.length;i++){e=this.calNextNoteTimer(i,e);var a=this.lines[this._ballList[i].ballDir].position.x,s=this._ballList[i].timeAppear*N.PLAYER_MOVE_SPEED+N.BIASED_OFFSET,n=cc.v3(a,s,0),l=this.setFixedPattern(i),o=l.isLeft,r=l.shouldFlip,u=new D(this._ballList[i].timeAppear,this._ballList[i].duration,this._ballList[i].ballDir,this._ballList[i].isShort,e,n,o,r);this.musicNoteDatas.push(u)}t(0)}},{key:"calNextNoteTimer",value:function(t,e){return t<this._ballList.length-1&&(e=this._ballList[t+1].timeAppear,t<this._ballList.length-2&&f.approx(this._ballList[t].timeAppear,this._ballList[t+1].timeAppear,f.EPSILON)&&(e=this._ballList[t+2].timeAppear,t<this._ballList.length-3&&f.approx(this._ballList[t].timeAppear,this._ballList[t+2].timeAppear,f.EPSILON)?e=this._ballList[t+3].timeAppear:t>0&&f.approx(this._ballList[t].timeAppear,this._ballList[t-1].timeAppear,f.EPSILON)&&(e=this._ballList[t+3].timeAppear))),e}},{key:"setFixedPattern",value:function(t){var e=!1,i=!0;return 0==t?{isLeft:i,shouldFlip:e}:Math.abs(this._ballList[t-1].timeAppear-this._ballList[t-1].timeAppear)<.01?{isLeft:i=this.musicNoteDatas[t-1].isLeft,shouldFlip:e}:this._ballList[t-1].isShort?(e=this.musicNoteDatas[t-1].shouldFlip,{isLeft:i=this.musicNoteDatas[t-1].isLeft,shouldFlip:e}):this.musicNoteDatas[t-1].isLeft?{isLeft:i,shouldFlip:e=!0}:{isLeft:i,shouldFlip:e}}},{key:"update",value:function(t){var e=this;switch(console.log("dt p = "+L.instance.deltaTime),L.instance.maxSubStep=2,this.gameState){case K.Init:this.isMusicLoaded&&this.isMidiLoaded&&this.setState(K.Idle);break;case K.Idle:this.player.setState(I.Started),this.setState(K.Run);break;case K.Run:null!=this.tileNodes&&this.tileNodes.filter((function(t){return t.node.position.y+.5<e.player.node.position.y&&!t.collided})).length>0&&(this.gameResult=V.Lose,this.setState(K.End))}}},{key:"onCollideTileNode",value:function(){this.gameScore++,g.MainUI.setScore(this.gameScore)}}]),e}(_)).prototype,"laneWidth",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),x=i(w.prototype,"lines",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),U=i(w.prototype,"blueNode",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=i(w.prototype,"pinkNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=i(w.prototype,"player",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(w.prototype,"mainCamera",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=w))||T)),c._RF.pop()}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../core/event-manager.js","../core/AmaWrapper.js","../core/DownloadFileUtil.js","../core/InputManager.js","../core/MidiNoteGenerator.js","../core/NoteData.js","../core/SoundManager.js","../game/CamFollow.js","../game/ComponentInstance.js","../game/LinePoint.js","../game/CurveLine.js","../game/GameConstant.js","../game/LevelData.js","../game/MainUI.js","../game/MusicDataNote.js","../game/NoteController.js","../game/TileNode.js","../game/Player.js","../game/GamePlay.js"],(function(n,e){return{setters:[function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/scripts/core/event-manager.js', 'chunks:///core/event-manager.js');
  r('project:///assets/scripts/core/AmaWrapper.js', 'chunks:///core/AmaWrapper.js');
  r('project:///assets/scripts/core/DownloadFileUtil.js', 'chunks:///core/DownloadFileUtil.js');
  r('project:///assets/scripts/core/InputManager.js', 'chunks:///core/InputManager.js');
  r('project:///assets/scripts/core/MidiNoteGenerator.js', 'chunks:///core/MidiNoteGenerator.js');
  r('project:///assets/scripts/core/NoteData.js', 'chunks:///core/NoteData.js');
  r('project:///assets/scripts/core/SoundManager.js', 'chunks:///core/SoundManager.js');
  r('project:///assets/scripts/game/CamFollow.js', 'chunks:///game/CamFollow.js');
  r('project:///assets/scripts/game/ComponentInstance.js', 'chunks:///game/ComponentInstance.js');
  r('project:///assets/scripts/game/LinePoint.js', 'chunks:///game/LinePoint.js');
  r('project:///assets/scripts/game/CurveLine.js', 'chunks:///game/CurveLine.js');
  r('project:///assets/scripts/game/GameConstant.js', 'chunks:///game/GameConstant.js');
  r('project:///assets/scripts/game/LevelData.js', 'chunks:///game/LevelData.js');
  r('project:///assets/scripts/game/MainUI.js', 'chunks:///game/MainUI.js');
  r('project:///assets/scripts/game/MusicDataNote.js', 'chunks:///game/MusicDataNote.js');
  r('project:///assets/scripts/game/NoteController.js', 'chunks:///game/NoteController.js');
  r('project:///assets/scripts/game/TileNode.js', 'chunks:///game/TileNode.js');
  r('project:///assets/scripts/game/Player.js', 'chunks:///game/Player.js');
  r('project:///assets/scripts/game/GamePlay.js', 'chunks:///game/GamePlay.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});